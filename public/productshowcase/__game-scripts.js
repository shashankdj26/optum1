var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)}))},TouchInput.prototype.getPinchDistance=function(t,i){var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInput.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInput.prototype.onTouchStartEndCancel=function(t){if(!window.imageOpened){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))}},TouchInput.fromWorldPoint=new pc.Vec3,TouchInput.toWorldPoint=new pc.Vec3,TouchInput.worldDiff=new pc.Vec3,TouchInput.prototype.pan=function(t){var i=TouchInput.fromWorldPoint,o=TouchInput.toWorldPoint,n=TouchInput.worldDiff,h=this.entity.camera,c=this.orbitCamera.distance;h.screenToWorld(t.x,t.y,c,i),h.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,c,o),n.sub2(o,i),this.orbitCamera.pivotPoint.add(n)},TouchInput.pinchMidPoint=new pc.Vec2,TouchInput.prototype.onTouchMove=function(t){if(!window.imageOpened){var i=TouchInput.pinchMidPoint,o=t.touches;if(1==o.length){var n=o[0];this.orbitCamera.pitch-=(n.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(n.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(n.x,n.y)}else if(2==o.length){var h=this.getPinchDistance(o[0],o[1]),c=h-this.lastPinchDistance;this.lastPinchDistance=h,this.orbitCamera.distance-=c*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(o[0],o[1],i),this.lastPinchMidPoint.copy(i)}}};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,i=function(){t._checkAspectRatio()};window.addEventListener("resize",i,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var e=this.entity.getRotation();if(this._yaw=this._calcYaw(e),this._pitch=this._clampPitchAngle(this._calcPitch(e,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var a=new pc.Vec3;a.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(a.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:distanceMax",function(t,i){this._targetDistance=this._clampDistance(this._distance)}),this.on("attr:pitchAngleMin",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:pitchAngleMax",function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)}),this.on("attr:focusEntity",function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)}),this.on("attr:frameOnStart",function(t,i){t&&this.focus(this.focusEntity||this.app.root)}),this.on("destroy",function(){window.removeEventListener("resize",i,!1)})},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){var e=0;if(t.model){var a=t.model.meshInstances;for(e=0;e<a.length;e++)0===i?this._modelsAabb.copy(a[e].aabb):this._modelsAabb.add(a[e].aabb),i+=1}for(e=0;e<t.children.length;++e)i+=this._buildAabb(t.children[e],i);return i},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.attributes.add("CanPan",{type:"boolean",default:!0}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,o=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",o,!1),this.on("destroy",function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",o,!1)})}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,e=MouseInput.toWorldPoint,i=MouseInput.worldDiff,n=this.entity.camera,s=this.orbitCamera.distance;n.screenToWorld(t.x,t.y,s,o),n.screenToWorld(this.lastPoint.x,this.lastPoint.y,s,e),i.sub2(e,o),this.orbitCamera.pivotPoint.add(i)},MouseInput.prototype.onMouseDown=function(t){if(!window.imageOpened)switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.CanPan&&(this.panButtonDown=!0)}},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.CanPan&&(this.panButtonDown=!1)}},MouseInput.prototype.onMouseMove=function(t){if(!window.imageOpened){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.CanPan&&this.pan(t),this.lastPoint.set(t.x,t.y)}},MouseInput.prototype.onMouseWheel=function(t){window.imageOpened||(this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault())},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.CanPan&&(this.panButtonDown=!1)};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera},KeyboardInput.prototype.postInitialize=function(){this.orbitCamera&&(this.startDistance=this.orbitCamera.distance,this.startYaw=this.orbitCamera.yaw,this.startPitch=this.orbitCamera.pitch,this.startPivotPosition=this.orbitCamera.pivotPoint.clone())},KeyboardInput.prototype.update=function(t){this.orbitCamera&&this.app.keyboard.wasPressed(pc.KEY_SPACE)&&(this.orbitCamera.reset(this.startYaw,this.startPitch,this.startDistance),this.orbitCamera.pivotPoint=this.startPivotPosition)};var LoadAssert=pc.createScript("loadAssert");LoadAssert.attributes.add("UVSpeed",{type:"number",default:2,title:"Pitch Angle Max (degrees)"}),LoadAssert.attributes.add("num",{type:"number",default:.1,title:"Pitch Angle Min (degrees)"}),this.model=null,this.material=null,LoadAssert.attributes.add("rotate_curve",{type:"curve",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),LoadAssert.prototype.initialize=function(){var t=this;this.app.assets.loadFromUrl("https://guoji.iweiyg.com/ceshi2/US_Body_Grill1.json","model",function(e,s){t.model=s;var a=new pc.Entity;a.addComponent("model",{asset:t.model}),t.app.root.addChild(a),a.translate(0,0,0)})},LoadAssert.prototype.update=function(t){this.model&&(this.num+=t/4*this.UVSpeed,this.num=this.num%1)};var ChangeColor=pc.createScript("changeColor");ChangeColor.attributes.add("cc_extension_frag",{type:"asset",assetType:"shader",title:"extension.frag"}),ChangeColor.attributes.add("cc_combine_frag",{type:"asset",assetType:"shader",title:"combine.frag"}),ChangeColor.attributes.add("cc_reflection_cubemap",{type:"asset",assetType:"cubemap",title:"cubemap"}),ChangeColor.attributes.add("cc_mats",{type:"asset",assetType:"material",title:"materials",array:!0}),ChangeColor.attributes.add("showMode",{title:"mix mode",type:"number",default:0,enum:[{base:0},{coat:4},{reflection:3},{mix:1},{add:2}]}),ChangeColor.attributes.add("bEnableChangeColor",{type:"boolean",default:!0,title:"enable clearcaot"}),ChangeColor.attributes.add("bEnableAlbedo",{type:"boolean",default:!0,title:"enable diffuse"}),ChangeColor.attributes.add("cc_albedo",{type:"rgb",default:[1,1,1],title:"diffuse"}),ChangeColor.attributes.add("bEnableAO",{type:"boolean",default:!0,title:"enable ChangeColor ao"}),ChangeColor.attributes.add("bEnableAdjustContrast",{type:"boolean",default:!0,title:"enable contrast / brightness"}),ChangeColor.attributes.add("cc_metalness",{type:"number",title:"metalness",min:0,max:1,step:.1,default:.5,description:"metalness value"}),ChangeColor.attributes.add("cc_dGlossiness",{type:"number",min:0,max:1,step:.1,default:.5,title:"glossiness"}),ChangeColor.attributes.add("cc_reflection_reflectivity",{type:"number",min:0,max:10,step:.1,default:5,title:"reflectivity"}),ChangeColor.attributes.add("cc_reflection_strength",{type:"number",min:0,max:2,step:.1,default:1,title:"strength"}),ChangeColor.attributes.add("cc_contrast_value",{type:"number",min:-1,max:1,step:1,default:0,title:"contrast"}),ChangeColor.attributes.add("cc_brightness_value",{type:"number",min:-1,max:1,step:.1,default:0,title:"brightness"}),ChangeColor.attributes.add("cc_custom_weight_base",{type:"number",min:1,max:5,step:.1,default:3,title:"mix strength"}),ChangeColor.attributes.add("decal_textures",{type:"asset",assetType:"texture",title:"textures",array:!0}),ChangeColor.attributes.add("decal_index",{type:"number",default:0}),ChangeColor.attributes.add("decal_uv",{type:"number",default:0,enum:[{UV0:0},{UV1:1}]}),ChangeColor.attributes.add("decal_mode",{type:"number",default:0,enum:[{"base layer":0},{"coat layer":1}]}),ChangeColor.attributes.add("decal_weight",{type:"number",min:0,max:1,step:.1,default:0,title:"decal_weight"}),ChangeColor.attributes.add("bEnableDecal",{type:"boolean",default:!1,title:"enble decal"}),ChangeColor.prototype.initialize=function(){this.bMatReady=!1,this.mat=this.cc_mats[0].resource,this.on("attr:bEnableChangeColor",this.updateCCParams,this),this.on("attr:bEnableAlbedo",this.updateCCParams,this),this.on("attr:bEnableAO",this.updateCCParams,this),this.on("attr:cc_albedo",this.updateCCParams,this),this.on("attr:cc_metalness",this.updateCCParams,this),this.on("attr:cc_custom_weight_base",this.updateCCParams,this),this.on("attr:cc_dGlossiness",this.updateCCParams,this),this.on("attr:cc_contrast_value",this.updateCCParams,this),this.on("attr:cc_brightness_value",this.updateCCParams,this),this.on("attr:cc_reflection_reflectivity",this.updateCCParams,this),this.on("attr:cc_reflection_strength",this.updateCCParams,this),this.on("attr:bEnableAdjustContrast",this.updateCCParams,this),this.on("attr:cc_reflection_cubemap",this.updateCCParams,this),this.on("attr:showMode",this.updateCCParams,this),this.on("attr:decal_textures",this.updateDecalParams,this),this.on("attr:decal_weight",this.updateDecalParams,this),this.on("attr:decal_index",this.updateDecalParams,this),this.on("attr:decal_mode",this.updateDecalParams,this),this.on("attr:bEnableDecal",this.updateDecalParams,this),this.initShader()},ChangeColor.prototype.initShader=function(t){for(var e=0;e<this.cc_mats.length;e++){this.mat=this.cc_mats[e].resource;var a="";a+=this.bEnableDecal?"#define ENABLE_DECAL\n":"",a+="#define DECAL_UV"+this.decal_uv+"\n";var s="";s+=this.mat.aoMap?"#define AO_UV"+this.mat.aoMapUv+"\n":"",this.mat.chunks.reflDirPS=a+s+(this.cc_extension_frag&&this.cc_extension_frag.resource||""),this.mat.chunks.endPS=this.cc_combine_frag&&this.cc_combine_frag.resource||""}this.updateCCParams(),this.updateDecalParams()},ChangeColor.prototype.updateCCParams=function(t){for(var e=0;e<this.cc_mats.length;e++)this.mat=this.cc_mats[e].resource,this.mat.setParameter("uc_dAlbedo",[this.cc_albedo.r,this.cc_albedo.g,this.cc_albedo.b]),this.mat.setParameter("uc_metalness",this.cc_metalness),this.mat.setParameter("uc_dGlossiness",this.cc_dGlossiness),this.mat.setParameter("contrast_base",.5),this.mat.setParameter("contrast_value",this.cc_contrast_value),this.mat.setParameter("brightness_value",this.cc_brightness_value),this.mat.setParameter("coat_weight_base",this.cc_custom_weight_base),this.mat.setParameter("reflection_cubemap",this.cc_reflection_cubemap.resource),this.mat.setParameter("reflection_reflectivity",this.cc_reflection_reflectivity),this.mat.setParameter("reflection_strength",this.cc_reflection_strength),this.mat.setParameter("enable_cc",this.bEnableChangeColor),this.mat.setParameter("enable_adjust_contrast",this.bEnableAdjustContrast),this.mat.setParameter("enable_ao",this.bEnableAO),this.mat.setParameter("enable_albedo",this.bEnableAlbedo),this.mat.setParameter("show_mode",this.showMode),this.mat.update()},ChangeColor.prototype.updateDecalParams=function(t){for(var e=0;e<this.cc_mats.length;e++)this.mat=this.cc_mats[e].resource,this.mat.setParameter("enable_decal",this.bEnableDecal),this.decal_textures.length>0&&this.mat.setParameter("decal_texture",this.decal_textures[this.decal_index].resource),this.mat.setParameter("decal_weight",this.decal_weight),this.mat.setParameter("decal_mode",this.decal_mode),this.mat.update()},ChangeColor.prototype.update=function(t){this.mat&&this.mat.shader&&this.mat.shader.definition.fshader&&!this.bMatReady&&(this.bMatReady=!0)};var Ceshi=pc.createScript("ceshi");Ceshi.attributes.add("UVSpeed",{type:"number",default:2,title:"Pitch Angle Max (degrees)"}),Ceshi.attributes.add("num",{type:"number",default:.1,title:"Pitch Angle Min (degrees)"}),this.model=null,this.material=null,Ceshi.attributes.add("rotate_curve",{type:"curve",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),Ceshi.attributes.add("cc_extension_frag",{type:"asset",assetType:"shader",title:"extension.frag"}),Ceshi.attributes.add("cc_combine_frag",{type:"asset",assetType:"shader",title:"combine.frag"}),Ceshi.attributes.add("cc_reflection_cubemap",{type:"asset",assetType:"cubemap",title:"cubemap"}),Ceshi.attributes.add("cc_mats",{type:"asset",assetType:"material",title:"materials",array:!0}),Ceshi.attributes.add("showMode",{title:"mix mode",type:"number",default:1,enum:[{base:0},{coat:4},{reflection:3},{mix:1},{add:2}]}),Ceshi.attributes.add("bEnableCeshi",{type:"boolean",default:!0,title:"enable clearcaot"}),Ceshi.attributes.add("bEnableAlbedo",{type:"boolean",default:!0,title:"enable diffuse"}),Ceshi.attributes.add("cc_albedo",{type:"rgb",default:[1,1,1],title:"diffuse"}),Ceshi.attributes.add("bEnableAO",{type:"boolean",default:!0,title:"enable Ceshi ao"}),Ceshi.attributes.add("bEnableAdjustContrast",{type:"boolean",default:!0,title:"enable contrast / brightness"}),Ceshi.attributes.add("cc_metalness",{type:"number",title:"metalness",min:0,max:1,step:.1,default:.5,description:"metalness value"}),Ceshi.attributes.add("cc_dGlossiness",{type:"number",min:0,max:1,step:.1,default:.5,title:"glossiness"}),Ceshi.attributes.add("cc_reflection_reflectivity",{type:"number",min:0,max:10,step:.1,default:5,title:"reflectivity"}),Ceshi.attributes.add("cc_reflection_strength",{type:"number",min:0,max:2,step:.1,default:1,title:"strength"}),Ceshi.attributes.add("cc_contrast_value",{type:"number",min:-1,max:1,step:1,default:0,title:"contrast"}),Ceshi.attributes.add("cc_brightness_value",{type:"number",min:-1,max:1,step:.1,default:0,title:"brightness"}),Ceshi.attributes.add("cc_custom_weight_base",{type:"number",min:1,max:5,step:.1,default:3,title:"mix strength"}),Ceshi.attributes.add("decal_textures",{type:"asset",assetType:"texture",title:"textures",array:!0}),Ceshi.attributes.add("decal_index",{type:"number",default:0}),Ceshi.attributes.add("decal_uv",{type:"number",default:0,enum:[{UV0:0},{UV1:1}]}),Ceshi.attributes.add("decal_mode",{type:"number",default:0,enum:[{"base layer":0},{"coat layer":1}]}),Ceshi.attributes.add("decal_weight",{type:"number",min:0,max:1,step:.1,default:0,title:"decal_weight"}),Ceshi.attributes.add("bEnableDecal",{type:"boolean",default:!1,title:"enble decal"}),Ceshi.prototype.initialize=function(){var t=this;this.app.assets.loadFromUrl("https://guoji.iweiyg.com/ceshi2/BS_Body.json","model",function(e,a){t.mat=a.resource.getMaterials()[4],t.cc_mats=new Array(1),t.cc_mats[0]=t.mat;var s=new pc.Entity;s.addComponent("model",{asset:a}),t.app.root.addChild(s),s.translate(0,0,0),s.rotateLocal(0,90,0),t.bMatReady=!1,t.on("attr:bEnableCeshi",t.updateCCParams,t),t.on("attr:bEnableAlbedo",t.updateCCParams,t),t.on("attr:bEnableAO",t.updateCCParams,t),t.on("attr:cc_albedo",t.updateCCParams,t),t.on("attr:cc_metalness",t.updateCCParams,t),t.on("attr:cc_custom_weight_base",t.updateCCParams,t),t.on("attr:cc_dGlossiness",t.updateCCParams,t),t.on("attr:cc_contrast_value",t.updateCCParams,t),t.on("attr:cc_brightness_value",t.updateCCParams,t),t.on("attr:cc_reflection_reflectivity",t.updateCCParams,t),t.on("attr:cc_reflection_strength",t.updateCCParams,t),t.on("attr:bEnableAdjustContrast",t.updateCCParams,t),t.on("attr:cc_reflection_cubemap",t.updateCCParams,t),t.on("attr:showMode",t.updateCCParams,t),t.on("attr:decal_textures",t.updateDecalParams,t),t.on("attr:decal_weight",t.updateDecalParams,t),t.on("attr:decal_index",t.updateDecalParams,t),t.on("attr:decal_mode",t.updateDecalParams,t),t.on("attr:bEnableDecal",t.updateDecalParams,t),t.initShader()})},Ceshi.prototype.initShader=function(t){for(var e=0;e<this.cc_mats.length;e++){this.mat=this.cc_mats[e];var a="";a+=this.bEnableDecal?"#define ENABLE_DECAL\n":"",a+="#define DECAL_UV"+this.decal_uv+"\n";var s="";s+=this.mat.aoMap?"#define AO_UV"+this.mat.aoMapUv+"\n":"",this.mat.chunks.viewDirPS=a+s+(this.cc_extension_frag&&this.cc_extension_frag.resource||""),this.mat.chunks.endPS=this.cc_combine_frag&&this.cc_combine_frag.resource||""}this.updateCCParams(),this.updateDecalParams()},Ceshi.prototype.updateCCParams=function(t){for(var e=0;e<this.cc_mats.length;e++)this.mat=this.cc_mats[e],this.mat.setParameter("uc_dAlbedo",[this.cc_albedo.r,this.cc_albedo.g,this.cc_albedo.b]),this.mat.setParameter("uc_metalness",this.cc_metalness),this.mat.setParameter("uc_dGlossiness",this.cc_dGlossiness),this.mat.setParameter("contrast_base",.5),this.mat.setParameter("contrast_value",this.cc_contrast_value),this.mat.setParameter("brightness_value",this.cc_brightness_value),this.mat.setParameter("coat_weight_base",this.cc_custom_weight_base),this.mat.setParameter("reflection_cubemap",this.cc_reflection_cubemap.resource),this.mat.setParameter("reflection_reflectivity",this.cc_reflection_reflectivity),this.mat.setParameter("reflection_strength",this.cc_reflection_strength),this.mat.setParameter("enable_cc",this.bEnableCeshi),this.mat.setParameter("enable_adjust_contrast",this.bEnableAdjustContrast),this.mat.setParameter("enable_ao",this.bEnableAO),this.mat.setParameter("enable_albedo",this.bEnableAlbedo),this.mat.setParameter("show_mode",this.showMode),this.mat.update()},Ceshi.prototype.updateDecalParams=function(t){for(var e=0;e<this.cc_mats.length;e++)this.mat=this.cc_mats[e],this.mat.setParameter("enable_decal",this.bEnableDecal),this.decal_textures.length>0&&this.mat.setParameter("decal_texture",this.decal_textures[this.decal_index].resource),this.mat.setParameter("decal_weight",this.decal_weight),this.mat.setParameter("decal_mode",this.decal_mode),this.mat.update()},Ceshi.prototype.update=function(t){this.model&&(this.num+=t/4*this.UVSpeed,this.num=this.num%1)};var Clearcoat=pc.createScript("clearcoat");Clearcoat.attributes.add("cc_extension_frag",{type:"asset",assetType:"shader",title:"extension.frag"}),Clearcoat.attributes.add("cc_combine_frag",{type:"asset",assetType:"shader",title:"combine.frag"}),Clearcoat.attributes.add("cc_reflection_cubemap",{type:"asset",assetType:"cubemap"}),Clearcoat.attributes.add("cc_mats",{type:"asset",assetType:"material",array:!0}),Clearcoat.attributes.add("showMode",{title:"mix mode",type:"number",default:0,enum:[{base:0},{coat:4},{reflection:3},{mix:1},{add:2}]}),Clearcoat.attributes.add("bEnableClearcoat",{type:"boolean",default:!0,title:"enable clearcaot"}),Clearcoat.attributes.add("bEnableAlbedo",{type:"boolean",default:!0,title:"enable diffuse"}),Clearcoat.attributes.add("cc_albedo",{type:"rgb",default:[1,1,1],title:"diffuse"}),Clearcoat.attributes.add("bEnableAO",{type:"boolean",default:!0,title:"enable clearcoat ao"}),Clearcoat.attributes.add("cc_metalness",{type:"number",min:0,max:1,step:.1,default:.6,title:"metalness"}),Clearcoat.attributes.add("cc_dGlossiness",{type:"number",min:0,max:1,step:.1,default:.3,title:"glossiness"}),Clearcoat.attributes.add("cc_reflection_reflectivity",{type:"number",min:0,max:10,step:.1,default:10,title:"reflectivity"}),Clearcoat.attributes.add("cc_reflection_strength",{type:"number",min:0,max:2,step:.1,default:1,title:"strength"}),Clearcoat.attributes.add("bEnableAdjustContrast",{type:"boolean",default:!0,title:"enable contrast / brightness"}),Clearcoat.attributes.add("cc_contrast_value",{type:"number",min:-1,max:1,step:1,default:0,title:"contrast"}),Clearcoat.attributes.add("cc_brightness_value",{type:"number",min:-1,max:1,step:.1,default:0,title:"brightness"}),Clearcoat.attributes.add("cc_custom_weight_base",{type:"number",min:1,max:5,step:.1,default:0,title:"mix strength"}),Clearcoat.attributes.add("decal_textures",{type:"asset",assetType:"texture",array:!0}),Clearcoat.attributes.add("decal_index",{type:"number",default:0}),Clearcoat.attributes.add("decal_uv",{type:"number",default:0,enum:[{UV0:0},{UV1:1}]}),Clearcoat.attributes.add("decal_mode",{type:"number",default:0,enum:[{"base layer":0},{"coat layer":1}]}),Clearcoat.attributes.add("decal_weight",{type:"number",min:0,max:1,step:.1,default:0,title:"decal_weight"}),Clearcoat.attributes.add("bEnableDecal",{type:"boolean",default:!1,title:"enble decal"}),Clearcoat.prototype.initialize=function(){this.bMatReady=!1,this.mat=this.cc_mats[0].resource,this.on("attr:bEnableClearcoat",this.updateCCParams,this),this.on("attr:bEnableAlbedo",this.updateCCParams,this),this.on("attr:bEnableAO",this.updateCCParams,this),this.on("attr:cc_albedo",this.updateCCParams,this),this.on("attr:cc_metalness",this.updateCCParams,this),this.on("attr:cc_custom_weight_base",this.updateCCParams,this),this.on("attr:cc_dGlossiness",this.updateCCParams,this),this.on("attr:cc_contrast_value",this.updateCCParams,this),this.on("attr:cc_brightness_value",this.updateCCParams,this),this.on("attr:cc_reflection_reflectivity",this.updateCCParams,this),this.on("attr:cc_reflection_strength",this.updateCCParams,this),this.on("attr:bEnableAdjustContrast",this.updateCCParams,this),this.on("attr:cc_reflection_cubemap",this.updateCCParams,this),this.on("attr:showMode",this.updateCCParams,this),this.on("attr:decal_textures",this.updateDecalParams,this),this.on("attr:decal_weight",this.updateDecalParams,this),this.on("attr:decal_index",this.updateDecalParams,this),this.on("attr:decal_mode",this.updateDecalParams,this),this.on("attr:bEnableDecal",this.updateDecalParams,this),this.initShader()},Clearcoat.prototype.initShader=function(){for(var t=0;t<this.cc_mats.length;t++){this.mat=this.cc_mats[t].resource;var e="";e+=this.bEnableDecal?"#define ENABLE_DECAL\n":"",e+="#define DECAL_UV"+this.decal_uv+"\n";var a="";a+=this.mat.aoMap?"#define AO_UV"+this.mat.aoMapUv+"\n":"",this.mat.chunks.viewDirPS=e+a+(this.cc_extension_frag&&this.cc_extension_frag.resource||""),this.mat.chunks.endPS=this.cc_combine_frag&&this.cc_combine_frag.resource||""}this.updateCCParams(),this.updateDecalParams()},Clearcoat.prototype.updateCCParams=function(){for(var t=0;t<this.cc_mats.length;t++)this.mat=this.cc_mats[t].resource,this.mat.setParameter("uc_dAlbedo",[this.cc_albedo.r,this.cc_albedo.g,this.cc_albedo.b]),this.mat.setParameter("uc_metalness",this.cc_metalness),this.mat.setParameter("uc_dGlossiness",this.cc_dGlossiness),this.mat.setParameter("contrast_base",.5),this.mat.setParameter("contrast_value",this.cc_contrast_value),this.mat.setParameter("brightness_value",this.cc_brightness_value),this.mat.setParameter("coat_weight_base",this.cc_custom_weight_base),this.mat.setParameter("reflection_cubemap",this.cc_reflection_cubemap.resource),this.mat.setParameter("reflection_reflectivity",this.cc_reflection_reflectivity),this.mat.setParameter("reflection_strength",this.cc_reflection_strength),this.mat.setParameter("enable_cc",this.bEnableClearcoat),this.mat.setParameter("enable_adjust_contrast",this.bEnableAdjustContrast),this.mat.setParameter("enable_ao",this.bEnableAO),this.mat.setParameter("enable_albedo",this.bEnableAlbedo),this.mat.setParameter("show_mode",this.showMode),this.mat.update()},Clearcoat.prototype.updateDecalParams=function(){for(var t=0;t<this.cc_mats.length;t++)this.mat=this.cc_mats[t].resource,this.mat.setParameter("enable_decal",this.bEnableDecal),this.decal_textures.length>0&&this.mat.setParameter("decal_texture",this.decal_textures[this.decal_index].resource),this.mat.setParameter("decal_weight",this.decal_weight),this.mat.setParameter("decal_mode",this.decal_mode),this.mat.update()},Clearcoat.prototype.update=function(t){return this.mat&&this.mat.shader&&this.mat.shader.definition.fshader&&!this.bMatReady&&(this.bMatReady=!0)};var Twincolor=pc.createScript("twincolor");Twincolor.attributes.add("twincolor_diffuse_frag",{type:"asset",assetType:"shader",title:"twincolor diffuse frag"}),Twincolor.attributes.add("twincolor_mat",{type:"asset",assetType:"material",title:"material"}),Twincolor.attributes.add("twincolor_color_1",{type:"rgb",title:"color 1"}),Twincolor.attributes.add("twincolor_color_2",{type:"rgb",title:"color 2"}),Twincolor.prototype.initialize=function(){this.on("attr:twincolor_color_1",this.updateTwinColorParams,this),this.on("attr:twincolor_color_2",this.updateTwinColorParams,this),this.on("attr:mask_uv",this.updateTwinColorShader,this),this.on("attr:mask_texture",this.updateTwinColorParams,this),this.updateTwinColorShader()},Twincolor.prototype.updateTwinColorShader=function(){this.mat=this.twincolor_mat.resource;var t="#define TWIN_COLOR_UV"+this.mat.diffuseMapUv+"\n";this.mat.chunks.diffusePS=t+(this.twincolor_diffuse_frag&&this.twincolor_diffuse_frag.resource||""),this.updateTwinColorParams()},Twincolor.prototype.updateTwinColorParams=function(){this.mat.setParameter("twincolor_color_1",[this.twincolor_color_1.r,this.twincolor_color_1.g,this.twincolor_color_1.b]),this.mat.setParameter("twincolor_color_2",[this.twincolor_color_2.r,this.twincolor_color_2.g,this.twincolor_color_2.b]),this.mat.update()},Twincolor.prototype.update=function(t){};var Reversal=pc.createScript("reversal");Reversal.attributes.add("speed",{type:"number",default:6}),Reversal.prototype.initialize=function(){this.entity.on("reversal:pasue",this.OnPause,this),this.entity.on("reversal:start",this.Onstart,this)},Reversal.prototype.update=function(e){this.entity.rotateLocal(0,e*this.speed*-1,0)},Reversal.prototype.OnPause=function(){this.speed=0},Reversal.prototype.Onstart=function(){this.speed=6},Reversal.prototype.swap=function(e){};var Rotate=pc.createScript("rotate");Rotate.attributes.add("speed",{type:"number",default:6}),Rotate.prototype.initialize=function(){this.entity.on("rotate:pasue",this.OnPause,this),this.entity.on("rotate:start",this.Onstart,this)},Rotate.prototype.update=function(t){this.entity.rotateLocal(0,t*this.speed,0)},Rotate.prototype.OnPause=function(){this.speed=0},Rotate.prototype.Onstart=function(){this.speed=6},Rotate.prototype.swap=function(t){};pc.script.createLoadingScreen(function(e){var t,a;t=["body {","    background-color: #283538;","}","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #283538;","}","#application-splash {","    position: absolute;","    top: calc(45% - 10px);","    width: 600px;","    left: calc(50% - 300px);","}","#application-splash img {","    width: 25%;","display: block;","margin-left: auto;","margin-right: auto;","margin-bottom: 10px","}","#progress-bar-container {","    margin:  25px auto 0 auto;","","    height: 10px;","    width: 100%;","    background-color: #1d292c;","}","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #00bcea;","}","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e),e.style.backgroundrepeat="no-repeat",e.style.backgroundSize="cover";var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none";var a=document.createElement("img");t.appendChild(a),a.onload=function(){t.style.display="block"};var n=document.createElement("div");n.id="progress-bar-container",t.appendChild(n);var o=document.createElement("div");o.id="progress-bar",n.appendChild(o);var i=document.createElement("p");i.id="progress-bar-message",i.innerHTML="Loading the environment...",t.appendChild(i),i.style.color="white",i.style.width="100%",i.style.fontSize="20px",i.style.fontFamily="sans-serif",i.style.fontStyle="normal",i.style.fontWeight="400",i.style.lineHeight="20px",i.style.textAlign="center"}(),e.on("preload:end",function(){e.off("preload:progress")}),e.on("preload:progress",function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%")}),e.on("start",function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)})});var Light=pc.createScript("light");Light.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),Light.attributes.add("carEntity",{type:"entity",title:"Car Entity"}),Light.prototype.initialize=function(){this.app.on("BTNmanger:Night",this.close_light,this)},Light.prototype.update=function(t){var i=new pc.Vec3;i.copy(this.carEntity.forward).normalize();var e=i.dot(this.cameraEntity.forward),a=this.entity;if(!0===this.nightBoolend){for(var n=0;n<a.length;++n)0===this.entity.name.indexOf("red")&&(e=-e),a[n].setParameter("material_opacity",e);this.entity.lookAt(this.cameraEntity.getPosition())}else for(var r=0;r<a.length;++r)a[r].setParameter("material_opacity",-1)},Light.prototype.close_light=function(t){1===t&&(this.nightBoolend=!0),0===t&&(this.nightBoolend=!1)};var Hotspot=pc.createScript("hotspot");Hotspot.attributes.add("turnOn",{type:"entity"}),Hotspot.attributes.add("turnOff",{type:"entity"}),Hotspot.prototype.initialize=function(){this.isShowing=!1,this.canInteract=!0,this.haveAnimationController=this.entity.script.positionAnimationController,this.manager=this.app.root.findByName("Manager").script.hotspotManager,this.turnOn.element.on("click",function(t){this.setHotsptShow()},this),this.turnOff.element.on("click",function(t){this.setHotsptShow()},this),this.entity.on("changeButtonState",function(){this.isShowing=!this.isShowing,this.isShowing&&(this.isShowing=!0)},this)},Hotspot.prototype.update=function(t){this.isShowing?(this.turnOn.enabled=!0,this.turnOff.enabled=!1):(this.turnOn.enabled=!1,this.turnOff.enabled=!0)},Hotspot.prototype.setHotsptShow=function(){this.canInteract&&this.haveAnimationController&&this.entity.fire("animate")},Hotspot.prototype.turnOffHotsptShow=function(){this.isShowing=!1};var LookAtoneAxis=pc.createScript("lookAtoneAxis");LookAtoneAxis.attributes.add("cameraEntity",{type:"entity",title:"Camera Entity"}),LookAtoneAxis.prototype.initialize=function(){},LookAtoneAxis.prototype.update=function(t){var o=this.cameraEntity.getPosition();this.entity.lookAt(o)};var HotspotManager=pc.createScript("hotspotManager");HotspotManager.attributes.add("hotspot1",{type:"entity"}),HotspotManager.attributes.add("hotspot2",{type:"entity"}),HotspotManager.attributes.add("hotspot3",{type:"entity"}),HotspotManager.prototype.initialize=function(){this.hotspot1_btn=this.hotspot1.script.hotspot,this.hotspot2_btn=this.hotspot2.script.hotspot,this.hotspot3_btn=this.hotspot3.script.hotspot},HotspotManager.prototype.update=function(t){},HotspotManager.prototype.disableAllOtherHotspot=function(){this.hotspot1_btn.turnOffHotsptShow(),this.hotspot2_btn.turnOffHotsptShow(),this.hotspot3_btn.turnOffHotsptShow()};var LoadUrlbutton=pc.createScript("loadUrlbutton");LoadUrlbutton.attributes.add("url",{type:"string",title:"URL",default:"https://expo.djvirtualevents.com/lobby"}),LoadUrlbutton.prototype.initialize=function(){this.entity.element.on("click",function(t){var e=document.createElement("a");e.href=this.url,e.target="_top",document.body.appendChild(e),e.click(),document.body.removeChild(e)},this)};var ColorManager=pc.createScript("colorManager");ColorManager.attributes.add("color",{type:"number",default:1,enum:[{Option1:1},{Option2:2},{OPtion3:3},{Option4:4}]}),ColorManager.attributes.add("body",{type:"entity",title:"Product"}),ColorManager.attributes.add("option1",{type:"asset",assetType:"material"}),ColorManager.attributes.add("option2",{type:"asset",assetType:"material"}),ColorManager.attributes.add("option3",{type:"asset",assetType:"material"}),ColorManager.attributes.add("option4",{type:"asset",assetType:"material"}),ColorManager.prototype.initialize=function(){console.log(this.body.model._materialEvents),console.log(this.body.model._materialEvents[14]),console.log(this.body.model.meshInstances),this.updateColor(1),this.screen=this.app.root.findByName("2D Screen"),this.Btn_Option1=this.screen.findByName("Option1"),this.Btn_Option1.element.on("click",function(t){this.updateColor(1)},this),this.Btn_Option2=this.screen.findByName("Option2"),this.Btn_Option2.element.on("click",function(t){this.updateColor(2)},this),this.Btn_Option3=this.screen.findByName("Option3"),this.Btn_Option3.element.on("click",function(t){this.updateColor(3)},this),this.Btn_Option4=this.screen.findByName("Option4"),this.Btn_Option4.element.on("click",function(t){this.updateColor(4)},this)},ColorManager.prototype.update=function(t){},ColorManager.prototype.updateColor=function(t){this.color=t;var e=this.body.model.meshInstances,o=e[0],i=e[1];switch(this.color){case 1:o.material=this.option1.resource,i.material=this.option1.resource;break;case 2:o.material=this.option2.resource,i.material=this.option2.resource;break;case 3:o.material=this.option3.resource,i.material=this.option3.resource;break;case 4:o.material=this.option4.resource,i.material=this.option4.resource}};var ChangeMat=pc.createScript("changeMat");ChangeMat.attributes.add("changeNum",{type:"number",default:0}),ChangeMat.attributes.add("current",{type:"number",default:0}),ChangeMat.attributes.add("materials",{type:"asset",assetType:"material",array:!0,title:"Materials"}),ChangeMat.prototype.initialize=function(){this.materialIndex=0,this.app.on("changeTheMaterial",this.changeToNextMaterial,this)},ChangeMat.prototype.update=function(t){},ChangeMat.prototype.changeToNextMaterial=function(t){var a=this.materials[t],e=this.entity.model.meshInstances;console.log(e.length);for(var n=0;n<e.length;++n){if(n==this.changeNum)e[n].material=a.resource}};var Button=pc.createScript("button");Button.attributes.add("num",{type:"number",default:0}),Button.prototype.initialize=function(){this.entity.element.on("click",this.onClick,this)},Button.prototype.update=function(t){},Button.prototype.onClick=function(t){this.app.fire("changeTheMaterial",this.num)};var OpenClose=pc.createScript("openClose");OpenClose.prototype.initialize=function(){this.open=!1},OpenClose.prototype.onClick=function(e){this.open?this.app.fire("setState","close"):this.app.fire("setState","open"),this.open=!this.open};var cantrigger,calAnimEnd,AnimationController=pc.createScript("animationController");AnimationController.attributes.add("model",{type:"entity"}),AnimationController.attributes.add("turnOn",{type:"entity"}),AnimationController.attributes.add("turnOff",{type:"entity"}),AnimationController.attributes.add("description",{type:"entity",title:"Description Entity"}),AnimationController.prototype.initialize=function(){this.hasAnimation=!1,this.hasTwoAnimation=!1,this.lastFrameCurrentTime=0,this.description.enabled=!1,this.turnOn.enabled=!0,this.turnOff.enabled=!1,this.model.animation&&(this.hasAnimation=!0,this.animator=this.model.animation,this.animator.loop=!1,this.animator.speed=1,this.animOpenName=this.app.assets.get(this.animator.assets[0]).name,this.blendTime=.2,this.animator.assets.length>=2&&(this.animCloseName=this.app.assets.get(this.animator.assets[1]).name,cantrigger=!0)),this.turnOn.element.on("click",function(t){cantrigger&&this.playOpeningAniamtion()},this),this.turnOff.element.on("click",function(t){cantrigger&&this.playClosingAniamtion()},this)},AnimationController.prototype.update=function(t){calAnimEnd&&(this.animator.currentTime==this.animator.duration||this.lastFrameCurrentTime>this.animator.currentTime?(calAnimEnd=!1,cantrigger=!0,this.description.enabled=!this.description.enabled,this.lastFrameCurrentTime=0,console.log("this is working "+this.lastFrameCurrentTime)):(this.lastFrameCurrentTime=this.animator.currentTime,console.log("lastFrameTime "+this.lastFrameCurrentTime)))},AnimationController.prototype.playOpeningAniamtion=function(){this.hasAnimation&&(cantrigger=!1,setTimeout(function(){calAnimEnd=!0},1e3),this.turnOn.enabled=!1,this.turnOff.enabled=!0,this.animator.play(this.animOpenName,this.blendTime))},AnimationController.prototype.playClosingAniamtion=function(){this.hasAnimation&&(this.hasTwoAnimation,cantrigger=!1,setTimeout(function(){calAnimEnd=!0},1e3),this.turnOn.enabled=!0,this.turnOff.enabled=!1,this.animator.play(this.animCloseName,this.blendTime))};var StallHotspot=pc.createScript("stallHotspot");StallHotspot.attributes.add("stallHandler",{type:"entity"}),StallHotspot.attributes.add("turnOn",{type:"entity"}),StallHotspot.attributes.add("turnOff",{type:"entity"}),StallHotspot.prototype.initialize=function(){this.turnOn.enabled=!0,this.turnOff.enabled=!1,this.entity.element.on("click",function(t){this.stallHandler.script.stallHtmlHandler.showStallContent(),this.turnOn.enabled?(this.turnOn.enabled=!1,this.turnOff.enabled=!0):(this.turnOn.enabled=!0,this.turnOff.enabled=!1)},this)},StallHotspot.prototype.update=function(t){};var stallComponent,StallHtmlHandler=pc.createScript("stallHtmlHandler");function closeStallConetent(){stallComponent&&stallComponent.removeIFRMAE(),document.getElementById("stall-container")&&document.getElementById("stall-container").remove()}StallHtmlHandler.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),StallHtmlHandler.prototype.initialize=function(){this.asset=null,this.assetId=0,this.counter=0},StallHtmlHandler.prototype.attachAsset=function(t,e){if(this.assetId=t,stallComponent=this,!this.assetId)return e.call(this);var s=this.app.assets.get(this.assetId),l=this;s._onLoad=function(t){e.call(l,t,t.resource)},s.on("load",s._onLoad),e.call(this,s,s.resource),this.app.assets.load(s)},StallHtmlHandler.prototype.template=function(t,e){this.asset&&this.asset!==t&&this.asset.off("load",this.asset._onLoad),this.asset=t,this.element.innerHTML=e||""},StallHtmlHandler.prototype.showStallContent=function(){console.log("render");var t=this;document.getElementById("stall-container")&&document.getElementById("stall-container").remove(),this.element=document.createElement("div"),this.element.classList.add("stall-container"),this.element.setAttribute("id","stall-container"),document.body.appendChild(this.element),this.asset=null,this.assetId=0,this.counter=0,this.assetId!==this.html.id&&this.attachAsset(this.html.id,this.template),this.element.getElementsByClassName("close")[0]&&(this.element.getElementsByClassName("close")[0].style.display="none",setTimeout(function(){t.element.getElementsByClassName("close")[0].style.display="block"},1500))},StallHtmlHandler.prototype.removeIFRMAE=function(){this.element.remove()};var StallHotspot1=pc.createScript("stallHotspot1");StallHotspot1.attributes.add("stallHandler",{type:"entity"}),StallHotspot1.prototype.initialize=function(){this.entity.element.on("click",function(t){this.stallHandler.script.stallHtmlHandler&&this.stallHandler.script.stallHtmlHandler.showStallContent(),this.stallHandler.script.pdfHandler&&this.stallHandler.script.pdfHandler.render()},this)},StallHotspot1.prototype.update=function(t){};var CssManager=pc.createScript("cssManager");CssManager.attributes.add("css",{type:"asset",assetType:"css",title:"CSS Asset"}),CssManager.prototype.initialize=function(){this.element=document.createElement("style"),document.head.appendChild(this.element),this.asset=null,this.assetId=0},CssManager.prototype.attachAsset=function(s,t){if(this.assetId=s,!this.assetId)return t.call(this);var e=this.app.assets.get(this.assetId),a=this;e._onLoad=function(s){t.call(a,s,s.resource)},e.on("load",e._onLoad),t.call(this,e,e.resource),this.app.assets.load(e)},CssManager.prototype.template=function(s,t){this.asset&&this.asset!==s&&this.asset.off("load",this.asset._onLoad),this.asset=s,this.element.innerHTML=t||""},CssManager.prototype.update=function(s){this.assetId!==this.css.id&&this.attachAsset(this.css.id,this.template)};var VimeoController=pc.createScript("vimeoController");VimeoController.attributes.add("videoUrl",{type:"string"}),VimeoController.attributes.add("contScreen",{type:"entity"}),VimeoController.attributes.add("contButton",{type:"entity"}),VimeoController.attributes.add("mainObjects",{type:"entity"}),VimeoController.attributes.add("hotspotVideo",{type:"entity"}),VimeoController.attributes.add("hotspotVideoUrl",{type:"string"}),VimeoController.prototype.initialize=function(){var e=this;this.init=!1,e.mainObjects.sound.volume=.6,this.app.on("skipVideo",function(){e.StopVimeoVideo(),e.mainObjects.enabled=!0,e.mainObjects.sound.volume=.6,e.contScreen.enabled=!1}),this.app.on("closeVideo",function(){e.StopVimeoVideo(),e.mainObjects.sound.volume=.6}),this.contButton.element.on("click",function(){e.mainObjects.enabled=!0,e.contScreen.enabled=!1}),this.hotspotVideo.element.on("click",function(){this.initvimeo(this.hotspotVideoUrl,!0,!1,!1,"72vw","84vh"),e.mainObjects.sound.volume=.1},this)},VimeoController.prototype.initvimeo=function(e,t,i,o,n,l){var s=this,r=document.createElement("div");if(r.id="player",r.classList.add("popover-modal"),r.style.display="flex",r.style.justifyContent="center",r.style.alignContent="center",r.style.alignItems="center",r.style.position="absolute",r.style.left="0",r.style.top="0",r.style.width="100%",r.style.height="100%",r.style.zIndex=10,r.style.background=t?"#040404d6 none repeat scroll 0% 0%":"black",r.style.marginRight="0",i){var a=document.createElement("img");a.setAttribute("src","https://storage.googleapis.com/virtual-event-273009.appspot.com/SkipButton.png"),a.style.position="absolute",a.style.top=0,a.style.right=0,a.style.margin="1%",a.id="skip",a.addEventListener("click",function(){s.app.fire("skipVideo")}),this.imgDiv=a,r.appendChild(a)}var d=document.querySelector("#play");d?d.appendChild(r):document.body.appendChild(r);var p=document.createElement("iframe");if(window.ReactHomeManager&&window.ReactHomeManager.ballRoomData&&(this.videoUrl=window.ReactHomeManager.ballRoomData.videoUrl),p.setAttribute("src",e),p.setAttribute("width","100%"),p.setAttribute("height","100%"),p.setAttribute("frameborder",0),p.setAttribute("allowfullscreen",!0),p.setAttribute("webkitallowfullscreen",!0),p.setAttribute("mozallowfullscreen",!0),p.setAttribute("mozallowfullscreen",!0),p.setAttribute("background",!1),p.setAttribute("autoplay",!1),p.setAttribute("byline",!1),p.setAttribute("loops",!1),p.setAttribute("title",!1),o||(p.style.width=n,p.style.height=l),console.log(p),t){var c=document.createElement("div");c.id="playerChild",c.classList.add("popover-modal"),c.style.display="flex",c.style.justifyContent="center",c.style.alignContent="center",c.style.alignItems="center",c.style.position="relative",c.style.zIndex=10,r.appendChild(c),c.appendChild(p);var m=document.createElement("img");m.setAttribute("src","https://storage.googleapis.com/virtual-event-273009.appspot.com/HotspotCloseButton.png"),m.id="skip",m.style.width="7%",m.style.maxWidth="80px",m.style.padding="2%",m.addEventListener("click",function(){s.app.fire("closeVideo")}),this.closeImgDiv=m,c.appendChild(m)}else r.appendChild(p);var u=new Vimeo.Player(p);u.on("play",function(){console.log("Played the  vimeo video")}),u.on("ended",function(){s.app.fire("skipVideo"),console.log("Played the  vimeo videoxxxx")}),this.videoPlayer=u,this.videoDiv=r,this.init=!0},VimeoController.prototype.StopVimeoVideo=function(){this.init=!1;var e=document.getElementById("player");e&&e.remove()};var VerticalPositionAnimation=pc.createScript("verticalPositionAnimation");VerticalPositionAnimation.attributes.add("animSpeed",{type:"number",default:.5,title:"Anim Speed"}),VerticalPositionAnimation.attributes.add("FinalPosition",{type:"vec3"}),VerticalPositionAnimation.attributes.add("ParentController",{type:"entity"}),VerticalPositionAnimation.prototype.initialize=function(){var t=this;this.entity.on("animate",function(){t.animate||(t.isClosed&&t.entity.element&&(t.entity.element.opacity=1),t.animate=!0)}),this.isClosed=!0,this.animate=!1,this.position=new pc.Vec3,this.startPosition=this.entity.getLocalPosition().clone(),this.entity.element&&(this.entity.element.opacity=0)},VerticalPositionAnimation.prototype.update=function(t){if(this.animate)if(this.isClosed)if(this.entity.getLocalPosition().y>this.FinalPosition.y){this.position=this.entity.getLocalPosition().clone();var i=new pc.Vec3(this.position.x,this.FinalPosition.y-10,0);this.position.lerp(this.position,i,t*this.animSpeed),this.entity.setLocalPosition(this.position)}else this.entity.setLocalPosition(this.FinalPosition),this.animate=!1,this.isClosed=!1,this.ParentController&&this.ParentController.fire("animationComplete",this.entity);else if(this.entity.getLocalPosition().y<this.startPosition.y){this.position=this.entity.getLocalPosition().clone();var e=new pc.Vec3(this.position.x,this.startPosition.y+20,0);this.position.lerp(this.position,e,t*this.animSpeed),this.entity.setLocalPosition(this.position)}else this.entity.setLocalPosition(this.startPosition),this.animate=!1,this.isClosed=!0,this.entity.element&&(this.entity.element.opacity=0),this.ParentController&&this.ParentController.fire("animationComplete",this.entity)};var PositionAnimationController=pc.createScript("positionAnimationController");PositionAnimationController.attributes.add("AnimationType",{type:"number",enum:[{parallel:1},{sequence:2}],default:1}),PositionAnimationController.attributes.add("AnimationEntities",{type:"entity",array:!0}),PositionAnimationController.attributes.add("playAtStart",{type:"boolean"}),PositionAnimationController.attributes.add("ScreenParent",{type:"entity"}),PositionAnimationController.attributes.add("ParentManager",{type:"entity"}),PositionAnimationController.prototype.initialize=function(){var t=this;this.openned=!1,this.hotspot=this.entity.script.hotspot,this.entity.on("animate",function(t){if(this.hotspot){if(console.log(this.hotspot.canInteract),!this.hotspot.canInteract)return void(t&&t(!1));t&&t(!0)}if(!this.ParentManager||t||this.openned)console.log(this.openned),1===this.AnimationType?this.parallelAnimation():this.sequenceAnimation(),this.entity.fire("changeButtonState"),this.hotspot.canInteract=!1;else{var n=this;this.ParentManager.fire("checkOthers",this.entity,function(t){t&&(1===n.AnimationType?n.parallelAnimation():n.sequenceAnimation(),n.entity.fire("changeButtonState"),n.hotspot.canInteract=!1)})}},this),this.entity.on("animationComplete",function(t){2===this.AnimationType?this.openned?(this.animationEntityIndex+=1,this.animationEntityIndex<this.AnimationEntities.length?this.AnimationEntities[this.animationEntityIndex].fire("animate"):this.hotspot&&(this.hotspot.canInteract=!0)):(this.animationEntityIndex-=1,this.animationEntityIndex>-1?this.AnimationEntities[this.animationEntityIndex].fire("animate"):(this.ScreenParent.enabled=!1,this.ParentManager&&this.ParentManager.fire("uncheckMe",this.entity),this.hotspot&&(this.hotspot.canInteract=!0))):(this.ScreenParent.enabled=!1,this.ParentManager&&this.ParentManager.fire("uncheckMe",this.entity),this.hotspot&&(this.hotspot.canInteract=!0))},this),this.playAtStart&&setTimeout(function(){console.log("callig"),t.entity.fire("animate")},1e3),this.ScreenParent.enabled=!1},PositionAnimationController.prototype.parallelAnimation=function(){this.openned=!this.openned,this.ScreenParent.enabled=!0;for(var t=0;t<this.AnimationEntities.length;t++)this.AnimationEntities[t].fire("animate")},PositionAnimationController.prototype.sequenceAnimation=function(){this.openned=!this.openned,this.openned?(this.ScreenParent.enabled=!0,this.animationEntityIndex=0,this.AnimationEntities[this.animationEntityIndex].fire("animate")):(this.animationEntityIndex=this.AnimationEntities.length-1,this.AnimationEntities[this.animationEntityIndex].fire("animate"))};var HorizontalPositionAnimation=pc.createScript("horizontalPositionAnimation");HorizontalPositionAnimation.attributes.add("animSpeed",{type:"number",default:.5,title:"Anim Speed"}),HorizontalPositionAnimation.attributes.add("FinalPosition",{type:"vec3"}),HorizontalPositionAnimation.attributes.add("ParentController",{type:"entity"}),HorizontalPositionAnimation.prototype.initialize=function(){var t=this;this.entity.on("animate",function(){t.animate||(t.isClosed&&t.entity.element&&(t.entity.element.opacity=1),t.animate=!0)}),this.isClosed=!0,this.animate=!1,this.position=new pc.Vec3,this.startPosition=this.entity.getLocalPosition().clone(),this.entity.element&&(this.entity.element.opacity=0)},HorizontalPositionAnimation.prototype.update=function(t){if(this.animate)if(this.isClosed)if(this.entity.getLocalPosition().x>this.FinalPosition.x){this.position=this.entity.getLocalPosition().clone();var i=new pc.Vec3(this.FinalPosition.x-10,this.position.y,0);this.position.lerp(this.position,i,t*this.animSpeed),this.entity.setLocalPosition(this.position)}else this.entity.setLocalPosition(this.FinalPosition),this.animate=!1,this.isClosed=!1,this.ParentController&&this.ParentController.fire("animationComplete",this.entity);else if(this.entity.getLocalPosition().x<this.startPosition.x){this.position=this.entity.getLocalPosition().clone();var o=new pc.Vec3(this.startPosition.x+20,this.position.y,0);this.position.lerp(this.position,o,t*this.animSpeed),this.entity.setLocalPosition(this.position)}else this.entity.setLocalPosition(this.startPosition),this.animate=!1,this.isClosed=!0,this.ParentController&&this.ParentController.fire("animationComplete",this.entity)};var PositionAnimationManager=pc.createScript("positionAnimationManager");PositionAnimationManager.prototype.initialize=function(){this.current=null;var n=this;this.entity.on("checkOthers",function(t,i){n.current?n.current!=t&&n.current.fire("animate",function(r){r?(i(!0),n.current=t):i(!1)}):(i&&i(!0),n.current=t)}),this.entity.on("uncheckMe",function(t){n.current&&n.current==t&&(n.current=null)})};var ImageController=pc.createScript("imageController");ImageController.attributes.add("url",{type:"string"}),ImageController.prototype.initialize=function(){this.imageDiv=null,this.element.on("click",function(){this.openImage()},this)},ImageController.prototype.openImage=function(){var t=document.createElement("img");t.setAttribute("src","https://storage.googleapis.com/virtual-event-273009.appspot.com/SkipButton.png"),t.style.position="absolute",t.style.top=0,t.style.right=0,t.style.margin="1%",t.id="skip",t.addEventListener("click",function(){self.app.fire("skipVideo")}),this.imgDiv=t,videoDiv.appendChild(t)},ImageController.prototype.closeImage=function(){};var HotspotButton=pc.createScript("hotspotButton");HotspotButton.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),HotspotButton.prototype.initialize=function(){this.entity.element.on("click",function(t){window.imageOpened||(this.app.fire("openThisStallHotspot",this.html),window.imageOpened=!0)},this)},HotspotButton.prototype.openIframe=function(){this.app.fire("openThisStallHotspot",this.html)};var htmlManagerInstance,HtmlManager=pc.createScript("htmlManager");function closeStallConetent(){console.log("removinf iframe html Manager"),htmlManagerInstance&&htmlManagerInstance.removeIFRMAE(),document.getElementById("stall-container")&&document.getElementById("stall-container").remove(),window.imageOpened=!1}function downloadImage(t,e){axios({url:t,method:"GET",responseType:"blob"}).then(function(t){var a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",e),document.body.appendChild(n),n.click(),n.remove()})}function downloadImage1(){downloadImage("https://storage.googleapis.com/virtual-event-273009.appspot.com/Claas/Left%20Big%20Panels.jpg","LeftPanel.jpg")}function downloadImage2(){downloadImage("https://storage.googleapis.com/virtual-event-273009.appspot.com/Claas/Right%20Big%20Panels.jpg","rightPanel.jpg")}function downloadImage3(){downloadImage("https://storage.googleapis.com/virtual-event-273009.appspot.com/FBLeft%20Panel%20Stall.png","infoPanel.jpg")}function downloadImage4(){downloadImage("https://storage.googleapis.com/virtual-event-273009.appspot.com/FBLeft%20Panel%20Stall.png","infoPanel.jpg")}HtmlManager.prototype.initialize=function(){this.asset=null,this.assetId=0,this.counter=0,htmlManagerInstance=this;var t=this;this.app.on("openThisStallHotspot",function(e){t.showStallContent(e),t.app.fire("stopBackSideInteraction")})},HtmlManager.prototype.attachAsset=function(t,e){if(this.assetId=t,!this.assetId)return e.call(this);var a=this.app.assets.get(this.assetId),n=this;a._onLoad=function(t){e.call(n,t,t.resource)},a.on("load",a._onLoad),e.call(this,a,a.resource),this.app.assets.load(a)},HtmlManager.prototype.template=function(t,e){this.asset&&this.asset!==t&&this.asset.off("load",this.asset._onLoad),this.asset=t,this.element.innerHTML=e||""},HtmlManager.prototype.showStallContent=function(t){document.getElementById("stall-container")&&document.getElementById("stall-container").remove(),this.element=document.createElement("div"),this.element.classList.add("stall-container"),this.element.classList.add("popover-modal"),this.element.setAttribute("id","stall-container"),document.body.appendChild(this.element),this.asset=null,this.assetId=0,this.counter=0,this.assetId!==t.id&&this.attachAsset(t.id,this.template)},HtmlManager.prototype.removeIFRMAE=function(){this.element&&this.element.remove(),this.app.fire("startBackSideInteraction"),this.app.fire("resumeCanvas"),this.app.fire("hotspotCliked",-1)};